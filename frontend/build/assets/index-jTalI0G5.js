import{_ as V}from"./add-one-DenQ1X6U.js";import{U as v,d as A,L as F,M as x,r as f,v as L,b as R,o as q,w as a,e as t,y as E,u as i,E as Q,C as j,O as H,B as c,g as k,P as K,Q as W,z as w,a as X,p}from"./index-kLEe-31q.js";import{_ as Y}from"./TriggerFormModal.vue_vue_type_script_setup_true_lang-BGdRzXOm.js";import{_ as Z}from"./FormItem-C2ziP3u7.js";import{N as ee,_ as te}from"./Grid-CmLEm3vL.js";import{_ as ae}from"./FormItemGridItem-BiRqZE_B.js";import{N as ne}from"./DataTable-4ViTZyB6.js";import"./index-aa34KBYr.js";import"./Checkbox-HPhUtTKu.js";import"./Ellipsis-CEbBdn2n.js";import"./prop-BjyUHhTu.js";import"./download-C2161hUv.js";function oe(s){return v.Get("/api/triggers/list",{params:s})}function le(s){return v.Post("/api/triggers/",s)}function se(s){return v.Delete(`/api/triggers/${s}`)}function re(s){return v.Post("/api/triggers/upload",s)}const ie={class:"flex gap-4"},he=A({__name:"index",setup(s){function z({upload:o,edit:e,remove:b}){return[{title:"ID",key:"id",resizable:!0},{title:"名称",key:"name",render(n){return p("div",{},n.name)},resizable:!0},{title:"描述",key:"description",width:300},{title:"状态",key:"status",width:100,render(n){return p("div",{class:n.status==="enabled"?"text-success":"text-error"},n.status==="enabled"?"启用":"禁用")}},{title:"一次性触发",key:"once",width:100,render(n){return p("div",{},n.once?"是":"否")}},{title:"创建日期",key:"createdAt",resizable:!0},{title:"操作",key:"actions",render(n){return[p(c,{type:"primary",strong:!0,tertiary:!0,size:"small",onClick:()=>o(n)},{default:()=>"上传"}),p(c,{type:"info",strong:!0,tertiary:!0,size:"small",onClick:()=>e(n)},{default:()=>"修改"}),p(c,{type:"error",strong:!0,tertiary:!0,size:"small",onClick:()=>b(n)},{default:()=>"删除"})]}}]}const g=F(),h=x({value:[]}),_=f(!1),m=f(!1),N={modelType:"settings",name:"",code:"",description:"",status:"enabled",once:!1,uploader:void 0},y=f(JSON.parse(JSON.stringify(N))),u=f(!1);function d(o){u.value=!0,oe(o).then(e=>{h.value=e.data,u.value=!1}).catch(()=>{u.value=!1})}function S(o){window.$dialog.warning({title:"确认删除",content:`确定要删除触发器 "${o.name}" 吗？此操作不可恢复`,positiveText:"确认删除",onPositiveClick:()=>{se(o.id).then(e=>{e.code===0&&(g.success("删除成功"),d())}).finally(()=>u.value=!1)}})}function M(o){u.value=!0,le(o).then(e=>{e.code===0&&(g.success(m.value?"修改成功":"创建成功"),d())}).finally(()=>{u.value=!1,_.value=!1})}const B=z({upload(o){re(o).then(e=>{e.code===0&&(g.success("上传成功"),d())})},edit(o){m.value=!0,y.value={...o},_.value=!0},remove:S});function O(){m.value=!1,y.value=JSON.parse(JSON.stringify(N)),_.value=!0}L(()=>{d()});const l=x({name:void 0,status:void 0,once:void 0});function U(){l.name=void 0,l.status=void 0,l.once=void 0,d(l)}return(o,e)=>{const b=Q,n=ae,T=j,$=K,G=W,I=te,J=Z,C=E,P=V,D=ne;return q(),R(i(w),{vertical:"",size:"large"},{default:a(()=>[t(C,null,{default:a(()=>[t(J,{model:l,"label-placement":"left",inline:"","show-feedback":!1},{default:a(()=>[t(i(ee),{cols:"1 s:2 m:3 l:6","x-gap":12,"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[t(n,{span:"1",label:"名称",path:"name"},{default:a(()=>[t(b,{value:l.name,"onUpdate:value":e[0]||(e[0]=r=>l.name=r),placeholder:"请输入要搜索的名称关键词"},null,8,["value"])]),_:1}),t(n,{span:"1",label:"状态",path:"status"},{default:a(()=>[t(T,{value:l.status,"onUpdate:value":e[1]||(e[1]=r=>l.status=r),placeholder:"请选择状态",options:[{label:"启用",value:"enabled"},{label:"禁用",value:"disabled"}],clearable:""},null,8,["value"])]),_:1}),t(n,{span:"1",label:"一次性",path:"once"},{default:a(()=>[t(T,{value:l.once,"onUpdate:value":e[2]||(e[2]=r=>l.once=r),placeholder:"请选择是否一次性",options:[{label:"是",value:!0},{label:"否",value:!1}],clearable:""},null,8,["value"])]),_:1}),t(I,{span:"1"},{default:a(()=>[t(i(H),{class:"ml-auto"},{default:a(()=>[t(i(c),{type:"primary",onClick:e[3]||(e[3]=r=>d(l))},{icon:a(()=>[t($)]),default:a(()=>[e[5]||(e[5]=k(" 搜索 "))]),_:1}),t(i(c),{strong:"",secondary:"",onClick:U},{icon:a(()=>[t(G)]),default:a(()=>[e[6]||(e[6]=k(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(C,null,{default:a(()=>[t(i(w),{vertical:"",size:"large"},{default:a(()=>[X("div",ie,[t(i(c),{type:"primary",onClick:O},{icon:a(()=>[t(P)]),default:a(()=>[e[7]||(e[7]=k(" 新建触发器 "))]),_:1})]),t(D,{columns:i(B),data:h.value,loading:u.value},null,8,["columns","data","loading"])]),_:1})]),_:1}),t(Y,{show:_.value,"onUpdate:show":e[4]||(e[4]=r=>_.value=r),"edit-mode":m.value,"initial-data":y.value,onSubmit:M},null,8,["show","edit-mode","initial-data"])]),_:1})}}});export{he as default};
