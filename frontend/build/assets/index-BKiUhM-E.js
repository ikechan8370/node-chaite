import{_ as q,a as D}from"./add-one-8AM-ZTV3.js";import{d as j,am as H,an as y,r as i,F as K,c as Q,o as W,e as o,w as a,ac as X,u as r,ah as Y,ao as O,B as _,g as h,ap as Z,aq as ee,ad as S,a as te,x as f,ar as oe,k as ae}from"./index-BjEaegUP.js";import{I as ne}from"./cloudy-CVZ16pF9.js";import{f as se,c as le,a as re}from"./presets-Aq8CRifq.js";import ie from"./PresetFormModal-CjUTk554.js";import{f as ue}from"./processors-DevYoRzT.js";import{f as pe}from"./toolGroup-BnOFbQC0.js";import{_ as ce}from"./FormItem-CbOKjIWi.js";import{N as de,_ as me}from"./Grid-o2FxrQJs.js";import{_ as _e}from"./FormItemGridItem-CSIse2iU.js";import"./Checkbox-CirA8Os6.js";import"./Ellipsis-BscbUQ8T.js";import"./prop-BjyUHhTu.js";import"./InputNumber-D6dFsLSZ.js";import"./CollapseItem-Bl978HYL.js";const fe={class:"flex gap-4"},ve=j({__name:"index",setup(ge){function I({edit:t,remove:e}){return[{title:"ID",key:"id"},{title:"名称",key:"name",render(s){const m=[s.name];return s.uploader&&m.push(f(oe,{trigger:"hover"},{trigger:()=>f(ne,{style:{color:"green"}}),default:()=>"云端预设"})),f(O,{align:"center"},{default:()=>m})}},{title:"前缀",key:"prefix"},{title:"温度",key:"sendMessageOption.temperature"},{title:"上传者",key:"uploader"},{title:"更新日期",key:"updatedAt"},{title:"创建日期",key:"createdAt"},{title:"操作",key:"actions",render(s){return[f(_,{type:"info",strong:!0,tertiary:!0,size:"small",onClick:()=>t(s)},{default:()=>"修改"}),f(_,{type:"error",strong:!0,tertiary:!0,size:"small",onClick:()=>e(s)},{default:()=>"删除"})]}}]}const u=H(),k=y({value:[]}),M=y({value:{}}),l=i(!1),c=i(!1),v=i(!1),P={modelType:"settings",name:"",embedded:!1,description:"",sendMessageOption:{systemOverride:"",temperature:.6,model:""},prefix:"",channelId:"",local:!0},g=i(JSON.parse(JSON.stringify(P))),x=i([]),N=i([]),b=i([]),n=y({name:void 0,prompt:""});function d(t){l.value=!0,se(t).then(e=>{k.value=e.data,l.value=!1}).catch(e=>{console.error(e),l.value=!1})}function w(){n.name=void 0,n.prompt="",d(n)}function T(){v.value=!1,g.value=JSON.parse(JSON.stringify(P)),c.value=!0}function B(t){v.value=!0,console.error(t),g.value={...t},c.value=!0}function G(t){window.$dialog.warning({title:"确认删除",content:`确定要删除预设 "${t.name}" 吗？此操作不可恢复。`,positiveText:"确认删除",negativeText:"取消",onPositiveClick:()=>{l.value=!0,re(t.id).then(e=>{e.code===0?(u.success("删除成功"),d(n)):u.error(e.message||"删除失败")}).catch(e=>{u.error(e.message||"删除操作发生错误")}).finally(()=>{l.value=!1})}})}function z(t){l.value=!0,le(t).then(e=>{e.code===0?(u.success(v.value?"更新成功":"创建成功"),d(n)):u.error(e.message),l.value=!1,c.value=!1}).catch(e=>{u.error(e.message),l.value=!1})}const F=I({edit(t){B(t)},remove(t){G(t)}});async function J(){try{const t=await ue({});x.value=t.data.filter(e=>e.type==="pre").map(e=>({label:e.name,value:e.id})),N.value=t.data.filter(e=>e.type==="post").map(e=>({label:e.name,value:e.id}))}catch(t){console.error(t)}}function L(t){pe(t).then(e=>{b.value=e.data.map(s=>({label:s.name,value:s.id}))})}return K(()=>{d(M.value),J(),L()}),(t,e)=>{const s=Y,m=_e,A=Z,R=ee,U=me,V=ce,C=X,$=q,E=D;return W(),Q("div",null,[o(r(S),{vertical:"",size:"large"},{default:a(()=>[o(C,null,{default:a(()=>[o(V,{ref:"formRef",model:n,"label-placement":"left",inline:"","show-feedback":!1},{default:a(()=>[o(r(de),{cols:"1 s:2 m:3 l:4","x-gap":12,"y-gap":16,responsive:"screen","item-responsive":""},{default:a(()=>[o(m,{span:"1",label:"名称",path:"name"},{default:a(()=>[o(s,{value:n.name,"onUpdate:value":e[0]||(e[0]=p=>n.name=p),placeholder:"请输入要搜索的名称关键词"},null,8,["value"])]),_:1}),o(m,{span:"1",label:"模型",path:"model"},{default:a(()=>[o(s,{value:n.prompt,"onUpdate:value":e[1]||(e[1]=p=>n.prompt=p),placeholder:"请输入要搜索的设定内容"},null,8,["value"])]),_:1}),o(U,{span:"1"},{default:a(()=>[o(r(O),{class:"ml-auto"},{default:a(()=>[o(r(_),{type:"primary",onClick:e[2]||(e[2]=p=>d(n))},{icon:a(()=>[o(A)]),default:a(()=>[e[4]||(e[4]=h(" 搜索 "))]),_:1}),o(r(_),{strong:"",secondary:"",onClick:w},{icon:a(()=>[o(R)]),default:a(()=>[e[5]||(e[5]=h(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(C,null,{default:a(()=>[o(r(S),{vertical:"",size:"large"},{default:a(()=>[te("div",fe,[o(r(_),{type:"primary",onClick:T},{icon:a(()=>[o($)]),default:a(()=>[e[6]||(e[6]=h(" 新建预设 "))]),_:1})]),o(E,{columns:r(F),data:k.value,loading:l.value},null,8,["columns","data","loading"])]),_:1})]),_:1})]),_:1}),o(ie,{show:c.value,"onUpdate:show":e[3]||(e[3]=p=>c.value=p),"edit-mode":v.value,"initial-data":g.value,"pre-processor-options":x.value,"post-processor-options":N.value,"tools-options":b.value,onSubmit:z},null,8,["show","edit-mode","initial-data","pre-processor-options","post-processor-options","tools-options"])])}}}),Ge=ae(ve,[["__scopeId","data-v-6ab303e4"]]);export{Ge as default};
