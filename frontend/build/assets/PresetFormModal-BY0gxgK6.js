import{d as c,c as y,o as C,a as n,r as N,s as $,x as S,e as s,u as t,J as q,w as l,y as X,E,z as b,g as d,C as p,aA as f,a0 as O,n as W,B as g,F as J,A as Q,t as Z,R,k as ee}from"./index-B99eYF-c.js";import{_ as te}from"./FormItem-Cx4Hdy7_.js";import{N as A}from"./Grid-C58T3vDH.js";import{_ as r}from"./FormItemGridItem-mgwSNAov.js";import{N as T}from"./InputNumber-C8tvygX9.js";import{N as se,a as le}from"./CollapseItem-ifpZgEPT.js";import{N as x}from"./Checkbox-DOmsmejg.js";const ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},M=c({name:"InformationCircleOutline",render:function(k,u){return C(),y("svg",ae,u[0]||(u[0]=[n("path",{d:"M248 64C146.39 64 64 146.39 64 248s82.39 184 184 184s184-82.39 184-184S349.61 64 248 64z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M220 220h32v116"},null,-1),n("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M208 340h88"},null,-1),n("path",{d:"M248 130a26 26 0 1 0 26 26a26 26 0 0 0-26-26z",fill:"currentColor"},null,-1)]))}}),U={HARM_BLOCK_METHOD_UNSPECIFIED:"HARM_BLOCK_METHOD_UNSPECIFIED",SEVERITY:"SEVERITY",PROBABILITY:"PROBABILITY"},w={HARM_CATEGORY_UNSPECIFIED:"HARM_CATEGORY_UNSPECIFIED",HARM_CATEGORY_HATE_SPEECH:"HARM_CATEGORY_HATE_SPEECH",HARM_CATEGORY_DANGEROUS_CONTENT:"HARM_CATEGORY_DANGEROUS_CONTENT",HARM_CATEGORY_HARASSMENT:"HARM_CATEGORY_HARASSMENT",HARM_CATEGORY_SEXUALLY_EXPLICIT:"HARM_CATEGORY_SEXUALLY_EXPLICIT",HARM_CATEGORY_CIVIC_INTEGRITY:"HARM_CATEGORY_CIVIC_INTEGRITY"},B={HARM_BLOCK_THRESHOLD_UNSPECIFIED:"HARM_BLOCK_THRESHOLD_UNSPECIFIED",BLOCK_LOW_AND_ABOVE:"BLOCK_LOW_AND_ABOVE",BLOCK_MEDIUM_AND_ABOVE:"BLOCK_MEDIUM_AND_ABOVE",BLOCK_ONLY_HIGH:"BLOCK_ONLY_HIGH",BLOCK_NONE:"BLOCK_NONE",OFF:"OFF"},oe={style:{display:"flex","align-items":"center",width:"100%"}},ne={key:0,class:"text-xs text-gray-500"},ie={style:{display:"flex","justify-content":"space-between","margin-bottom":"8px"}},re={style:{width:"100%"}},de={style:{"margin-bottom":"4px","font-size":"12px",display:"flex","align-items":"center"}},pe={style:{width:"100%"}},ue={style:{"margin-bottom":"4px","font-size":"12px",display:"flex","align-items":"center"}},ge={style:{width:"100%"}},me={style:{"margin-bottom":"4px","font-size":"12px",display:"flex","align-items":"center"}},ve={style:{display:"flex","justify-content":"flex-end","margin-top":"24px"}},fe=c({__name:"PresetFormModal",props:{show:Boolean,editMode:Boolean,initialData:{type:Object,default:()=>({})},preProcessorOptions:{type:Array,default:()=>[]},postProcessorOptions:{type:Array,default:()=>[]},toolsOptions:{type:Array,default:()=>[]}},emits:["update:show","submit"],setup(m,{emit:k}){const u=m,I=k,H=N(),_=$({get:()=>u.show,set:i=>I("update:show",i)}),L=[{label:"文本",value:"text"},{label:"图片",value:"image"}],P=[{label:"高",value:"high"},{label:"中",value:"medium"},{label:"低",value:"low"}],D=[{label:"无",value:"none"},{label:"ANY",value:"any"},{label:"AUTO",value:"auto"},{label:"指定",value:"specified"}],G=Object.entries(U).map(([i,e])=>({label:i,value:e})),Y=Object.entries(w).map(([i,e])=>({label:i,value:e})),z=Object.entries(B).map(([i,e])=>({label:i,value:e})),F={name:{required:!0,trigger:["blur","input"],message:"请输入预设名称"},description:{required:!0,trigger:["blur","change"],message:"请选择客户端类型"},prefix:{required:!0,trigger:["blur","input"],message:"请输入基础URL"},"sendMessageOption.model":{required:!0,trigger:["blur","input"],message:"请输入模型"}},a=N({modelType:"settings",name:"",embedded:!1,description:"",sendMessageOption:{systemOverride:"",temperature:.6,model:"",maxToken:4e3,disableHistoryRead:!1,disableHistorySave:!1,stream:!0,enableReasoning:!1,reasoningEffort:"medium",reasoningBudgetTokens:2e3,toolChoice:{type:"auto",tools:[]},toolGroupId:["default_local"],responseModalities:void 0,safetySettings:void 0},prefix:"",local:!0});S(()=>u.initialData,i=>{if(u.editMode&&i){const e={...i};e.sendMessageOption||(e.sendMessageOption={}),e.sendMessageOption.toolChoice||(e.sendMessageOption.toolChoice={type:"auto",tools:[]}),a.value=e}},{immediate:!0});function K(){a.value.sendMessageOption.safetySettings||(a.value.sendMessageOption.safetySettings=[]),a.value.sendMessageOption.safetySettings.push({method:U.HARM_BLOCK_METHOD_UNSPECIFIED,category:w.HARM_CATEGORY_UNSPECIFIED,threshold:B.HARM_BLOCK_THRESHOLD_UNSPECIFIED})}function V(i){a.value.sendMessageOption?.safetySettings&&a.value.sendMessageOption.safetySettings.splice(i,1)}function j(){H.value?.validate().then(i=>{if(Array.isArray(i)){console.error(i);return}I("submit",a.value),_.value=!1})}return S(_,i=>{!i&&!u.editMode&&(a.value={modelType:"settings",name:"",embedded:!1,description:"",sendMessageOption:{systemOverride:"",temperature:.6,model:"",maxToken:4e3,disableHistoryRead:!1,disableHistorySave:!1,stream:!0,enableReasoning:!1,reasoningEffort:"medium",reasoningBudgetTokens:2e3,toolChoice:{type:"auto",tools:[]},toolGroupId:["default_local"],responseModalities:void 0,safetySettings:void 0},prefix:"",local:!0})}),(i,e)=>(C(),y("div",null,[s(t(q),{show:_.value,"onUpdate:show":e[18]||(e[18]=o=>_.value=o),preset:"card",style:{width:"700px","max-width":"90vw"}},{default:l(()=>[s(t(X),{title:m.editMode?"编辑预设":"添加预设"},{default:l(()=>[s(t(te),{ref_key:"formRef",ref:H,rules:F,model:a.value},{default:l(()=>[s(t(A),{cols:24,"x-gap":12,"y-gap":16,responsive:"self","item-responsive":""},{default:l(()=>[s(t(r),{span:"12 s:8 m:8",label:"名称",path:"name"},{default:l(()=>[s(t(E),{value:a.value.name,"onUpdate:value":e[0]||(e[0]=o=>a.value.name=o),placeholder:"请输入预设名称"},null,8,["value"])]),_:1}),s(t(r),{span:"12 s:8 m:8",label:"前缀",path:"prefix"},{default:l(()=>[s(t(E),{value:a.value.prefix,"onUpdate:value":e[1]||(e[1]=o=>a.value.prefix=o),placeholder:"请输入前缀"},null,8,["value"])]),_:1}),s(t(r),{span:"12 s:8 m:8",label:"模型",path:"sendMessageOption.model"},{default:l(()=>[s(t(E),{value:a.value.sendMessageOption.model,"onUpdate:value":e[2]||(e[2]=o=>a.value.sendMessageOption.model=o),placeholder:"请输入模型"},null,8,["value"])]),_:1}),s(t(r),{span:"12 s:8 m:8",label:"温度",path:"sendMessageOption.temperature"},{default:l(()=>[s(t(T),{value:a.value.sendMessageOption.temperature,"onUpdate:value":e[3]||(e[3]=o=>a.value.sendMessageOption.temperature=o),placeholder:"请输入温度"},null,8,["value"])]),_:1}),s(t(r),{span:"12 s:8 m:8",label:"最大Token",path:"sendMessageOption.maxToken"},{default:l(()=>[s(t(T),{value:a.value.sendMessageOption.maxToken,"onUpdate:value":e[4]||(e[4]=o=>a.value.sendMessageOption.maxToken=o),placeholder:"请输入最大Token数"},null,8,["value"])]),_:1}),s(t(r),{span:"24",label:"系统提示词",path:"sendMessageOption.systemOverride"},{default:l(()=>[s(t(E),{value:a.value.sendMessageOption.systemOverride,"onUpdate:value":e[5]||(e[5]=o=>a.value.sendMessageOption.systemOverride=o),type:"textarea",placeholder:"请输入提示词"},null,8,["value"])]),_:1})]),_:1}),s(t(se),{class:"mt-4"},{default:l(()=>[s(t(le),{title:"高级设置",name:"advanced"},{default:l(()=>[s(t(A),{cols:24,"x-gap":12,"y-gap":16,responsive:"screen","item-responsive":""},{default:l(()=>[s(t(r),{span:"24 s:12 m:12",label:"历史记录设置",path:"historySettings"},{default:l(()=>[s(t(b),{align:"center"},{default:l(()=>[s(t(x),{checked:a.value.sendMessageOption.disableHistoryRead,"onUpdate:checked":e[6]||(e[6]=o=>a.value.sendMessageOption.disableHistoryRead=o)},{default:l(()=>e[19]||(e[19]=[d(" 禁用历史记录读取 ")])),_:1},8,["checked"]),s(t(x),{checked:a.value.sendMessageOption.disableHistorySave,"onUpdate:checked":e[7]||(e[7]=o=>a.value.sendMessageOption.disableHistorySave=o)},{default:l(()=>e[20]||(e[20]=[d(" 禁用历史记录保存 ")])),_:1},8,["checked"])]),_:1})]),_:1}),s(t(r),{span:"12 s:12 m:6",label:"流模式",path:"sendMessageOption.stream"},{default:l(()=>[s(t(x),{checked:a.value.sendMessageOption.stream,"onUpdate:checked":e[8]||(e[8]=o=>a.value.sendMessageOption.stream=o)},{default:l(()=>e[21]||(e[21]=[d(" 启用流模式 ")])),_:1},8,["checked"])]),_:1}),s(t(r),{span:"24",label:"推理设置",path:"reasoningSettings"},{default:l(()=>[s(t(A),{cols:24,"x-gap":12,"y-gap":16},{default:l(()=>[s(t(r),{span:"8",label:"启用推理",path:"sendMessageOption.enableReasoning"},{default:l(()=>[s(t(x),{checked:a.value.sendMessageOption.enableReasoning,"onUpdate:checked":e[9]||(e[9]=o=>a.value.sendMessageOption.enableReasoning=o)},{default:l(()=>e[22]||(e[22]=[d(" 启用推理 ")])),_:1},8,["checked"])]),_:1}),s(t(r),{span:"8",label:"推理强度",path:"sendMessageOption.reasoningEffort"},{default:l(()=>[s(t(p),{value:a.value.sendMessageOption.reasoningEffort,"onUpdate:value":e[10]||(e[10]=o=>a.value.sendMessageOption.reasoningEffort=o),options:P,placeholder:"请选择推理强度"},null,8,["value"])]),_:1}),s(t(r),{span:"8",label:"推理Token预算",path:"sendMessageOption.reasoningBudgetTokens"},{default:l(()=>[s(t(T),{value:a.value.sendMessageOption.reasoningBudgetTokens,"onUpdate:value":e[11]||(e[11]=o=>a.value.sendMessageOption.reasoningBudgetTokens=o),placeholder:"推理Token预算"},null,8,["value"])]),_:1})]),_:1})]),_:1}),s(t(r),{span:"24",label:"工具选择",path:"sendMessageOption.toolChoice"},{default:l(()=>[s(t(A),{cols:24,"x-gap":12,"y-gap":16},{default:l(()=>[s(t(r),{span:"24",label:"",path:"sendMessageOption.toolChoice.type"},{default:l(()=>[n("div",oe,[s(t(p),{value:a.value.sendMessageOption.toolChoice.type,"onUpdate:value":e[12]||(e[12]=o=>a.value.sendMessageOption.toolChoice.type=o),options:D,placeholder:"请选择工具选择类型",style:{flex:"1"}},null,8,["value"]),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"18",class:"ml-2",style:{"margin-left":"8px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[23]||(e[23]=n("span",null,'注意：如果选择了"任意"，则toolcall的下一轮assistant消息会自动变回"自动"模式，否则会无限使用工具。',-1))]),_:1})])]),_:1})]),_:1})]),_:1}),s(t(r),{span:"24",label:"响应模态",path:"sendMessageOption.responseModalities"},{default:l(()=>[s(t(p),{value:a.value.sendMessageOption.responseModalities,"onUpdate:value":e[13]||(e[13]=o=>a.value.sendMessageOption.responseModalities=o),multiple:"",placeholder:"请选择响应模态",options:L},null,8,["value"]),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"18",class:"ml-2",style:{"margin-left":"8px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[24]||(e[24]=n("span",null,"仅 Gemini 模型支持此功能",-1))]),_:1})]),_:1}),s(t(r),{span:"24",label:"安全设置",path:"sendMessageOption.safetySettings"},{default:l(()=>[n("div",null,[s(t(g),{size:"small",type:"primary",style:{"margin-bottom":"12px"},onClick:K},{default:l(()=>e[25]||(e[25]=[d(" 添加安全设置 ")])),_:1}),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"18",class:"ml-2",style:{"margin-left":"8px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[26]||(e[26]=n("span",null,"仅 Gemini 模型支持此功能",-1))]),_:1}),a.value.sendMessageOption?.safetySettings?.length===0?(C(),y("div",ne," 还没有添加安全设置 ")):W("",!0),(C(!0),y(J,null,Q(a.value.sendMessageOption?.safetySettings,(o,h)=>(C(),y("div",{key:h,style:{border:"1px solid #eee",padding:"12px","margin-bottom":"12px","border-radius":"4px"}},[n("div",ie,[n("strong",null,"安全设置 #"+Z(h+1),1),s(t(g),{size:"small",type:"error",onClick:v=>V(h)},{default:l(()=>e[27]||(e[27]=[d(" 删除 ")])),_:2},1032,["onClick"])]),s(t(b),{vertical:"",style:{width:"100%"}},{default:l(()=>[n("div",re,[n("div",de,[e[29]||(e[29]=d(" 方法 ")),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"16",style:{"margin-left":"4px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[28]||(e[28]=n("span",null,"确定伤害拦截方法是使用概率分数还是同时使用概率和严重程度分数",-1))]),_:1})]),s(t(p),{value:o.method,"onUpdate:value":v=>o.method=v,options:t(G),placeholder:"选择方法",style:{width:"100%"}},null,8,["value","onUpdate:value","options"])]),n("div",pe,[n("div",ue,[e[31]||(e[31]=d(" 类别 ")),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"16",style:{"margin-left":"4px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[30]||(e[30]=n("span",null,"伤害类别，指定需要检测和过滤的有害内容类型",-1))]),_:1})]),s(t(p),{value:o.category,"onUpdate:value":v=>o.category=v,options:t(Y),placeholder:"选择类别",style:{width:"100%"}},null,8,["value","onUpdate:value","options"])]),n("div",ge,[n("div",me,[e[33]||(e[33]=d(" 阈值 ")),s(t(f),{placement:"top",trigger:"hover"},{trigger:l(()=>[s(t(O),{size:"16",style:{"margin-left":"4px",cursor:"pointer"}},{default:l(()=>[s(t(M))]),_:1})]),default:l(()=>[e[32]||(e[32]=n("span",null,"伤害阻止阈值，决定在何种级别的风险程度下阻止内容生成",-1))]),_:1})]),s(t(p),{value:o.threshold,"onUpdate:value":v=>o.threshold=v,options:t(z),placeholder:"选择阈值",style:{width:"100%"}},null,8,["value","onUpdate:value","options"])])]),_:2},1024)]))),128))])]),_:1}),s(t(r),{span:"24 s:12 m:12",label:"处理器",path:"processors"},{default:l(()=>[s(t(b),null,{default:l(()=>[s(t(R),{trigger:"hover",placement:"bottom",width:260},{trigger:l(()=>[s(t(g),{size:"small"},{default:l(()=>e[34]||(e[34]=[d(" 前处理器 ")])),_:1})]),default:l(()=>[s(t(p),{value:a.value.sendMessageOption.preProcessorIds,"onUpdate:value":e[14]||(e[14]=o=>a.value.sendMessageOption.preProcessorIds=o),multiple:"",placeholder:"请选择前处理器",options:m.preProcessorOptions},null,8,["value","options"])]),_:1}),s(t(R),{trigger:"hover",placement:"bottom",width:260},{trigger:l(()=>[s(t(g),{size:"small"},{default:l(()=>e[35]||(e[35]=[d(" 后处理器 ")])),_:1})]),default:l(()=>[s(t(p),{value:a.value.sendMessageOption.postProcessorIds,"onUpdate:value":e[15]||(e[15]=o=>a.value.sendMessageOption.postProcessorIds=o),multiple:"",placeholder:"请选择后处理器",options:m.postProcessorOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),s(t(r),{span:"24 s:12 m:12",label:"工具",path:"tools"},{default:l(()=>[s(t(R),{trigger:"hover",placement:"bottom",width:260},{trigger:l(()=>[s(t(g),{size:"small"},{default:l(()=>e[36]||(e[36]=[d(" 工具组 ")])),_:1})]),default:l(()=>[s(t(p),{value:a.value.sendMessageOption.toolGroupId,"onUpdate:value":e[16]||(e[16]=o=>a.value.sendMessageOption.toolGroupId=o),multiple:"",placeholder:"请选择工具组",options:m.toolsOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n("div",ve,[s(t(b),null,{default:l(()=>[s(t(g),{onClick:e[17]||(e[17]=o=>_.value=!1)},{default:l(()=>e[37]||(e[37]=[d(" 取消 ")])),_:1}),s(t(g),{type:"primary",onClick:j},{default:l(()=>e[38]||(e[38]=[d(" 确定 ")])),_:1})]),_:1})])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])]))}}),Ae=ee(fe,[["__scopeId","data-v-b38a9903"]]);export{Ae as default};
